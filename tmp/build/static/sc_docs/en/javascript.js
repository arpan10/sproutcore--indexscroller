
Object.extend(String.English,{});Docs=SC.Object.create({server:SC.Server.create({prefix:['Docs']}),FIXTURES:[],controllers:[]});function main(){SC.page.awake();if(window.location.hostname.toString().indexOf('sproutcore.com')>=0){var clientRoot='sproutcore/-docs';var clientName='sproutcore';var canRebuild=NO;}else{var clientRoot=window.location.pathname.toString().replace(/-docs\/.*/,'-docs').substr(1,window.location.pathname.length);var clientName=clientRoot.match(/([^\/]+)\/-docs/)[1];var canRebuild=YES;}
Docs.docsController.set('selection',[]);Docs.docsController.set('clientRoot',clientRoot);Docs.docsController.set('clientName',clientName);Docs.docsController.set('canRebuild',canRebuild);Docs.docsController.reloadDocs();};require('core');Docs.DocLabelView=SC.ButtonView.extend({emptyElement:'<a href="javascript:;"><span></span></a>',contentObserver:function(){var c=this.get('content');this.set('labelText',(c)?c.get('title'):'(NONE)');}.observes('content'),labelSelector:'span',mouseDown:function(){return false;}});require('core');Docs.docsController=SC.Object.create({windowLocation:window.location.href.toString(),clientName:'',clientRoot:'',isRebuilding:false,canRebuild:NO,nowShowingContainer:function(){return(this.get('isRebuilding'))?'rebuilding':(this.get('selectedDoc'))?'runner':'empty';}.property('isRebuilding','selectedDoc'),displayClientName:function(){var clientName=(this.get('clientName')||'').humanize().capitalize();if(clientName.toLowerCase()=='sproutcore')clientName='SproutCore';return"%@ Reference".fmt(clientName);}.property('clientName'),nowShowingLabel:function(){var sel=this.get('selection');var rec=(sel&&sel.get('length')>0)?sel.objectAt(0):null;return(rec)?rec.get('title'):'';}.property('selection'),arrangedObjects:[],selection:[],selectedDoc:function(){var sel=this.get('selection');return(sel&&sel.length>0)?sel[0]:null;}.property('selection'),reloadDocs:function(){var clientName=this.get('clientName');var clientRoot=this.get('clientRoot');clientRoot=clientRoot.replace(new RegExp("^%@/?".fmt(window.indexPrefix)),window.urlPrefix+'/');console.log('clientName: '+clientRoot);Docs.server.request(clientRoot,['data',('classes.js?'+Math.random())].join('/'),null,{onSuccess:this._reloadSuccess.bind(this),onFailure:this._reloadFailure.bind(this)});},_reloadSuccess:function(status,transport){var json=transport.responseText;var records=eval(json);if($type(records)!=T_ARRAY){return this._reloadFailure(status,transport);}
var recs=SC.Store.updateRecords(records,this,Docs.Doc,true);console.log('recs: %@'.fmt(recs));if(recs.length==0){SC.page.get('noDocsPanel').set('isVisible',true);this.invokeLater(this.reloadDocs,2000);}else{SC.page.get('noDocsPanel').set('isVisible',false);}
this.set('allRecords',recs);},rebuildArrangedDocs:function(){var search=this.get('search');var recs=this.get('allRecords');if(search&&search.length>0){search=search.toLowerCase();var filtered=[];var idx=recs.get('length');while(--idx>=0){var rec=recs.objectAt(idx);var symbols=(rec.get('symbols')||'');if(symbols.indexOf(search)>=0)filtered.push(rec);}
recs=filtered;}
recs=recs.sort(function(a,b){var g_a=a.get('group')||'';var g_b=b.get('group')||'';var groupCompare=g_a.localeCompare(g_b);if(groupCompare==0){a=a.get('guid')||'';b=b.get('guid')||'';return a.localeCompare(b);}else return groupCompare;});var hadArrangedObjects=this.get('arrangedObjects').length>0;this.set('arrangedObjects',recs);var doc=this.get('selectedDoc');if(doc&&!(recs.include(doc)))this.set('selection',[]);}.observes('allRecords','search'),_reloadFailure:function(status,transport){console.log('TEST RELOAD FAILED!');},rebuildDocs:function(){var clientName=this.get('clientName');var clientRoot=this.get('clientRoot');Docs.server.request(clientRoot,null,null,{nonce:Date.now().toString(),onSuccess:this._rebuildSuccess.bind(this),onFailure:this._rebuildFailure.bind(this)},'post');this.set('isRebuilding',true);},_rebuildSuccess:function(){this.reloadDocs();this.set('isRebuilding',false);},_rebuildFailure:function(){this.set('isRebuilding',false);}});require('core');Docs.DocFrameView=SC.View.extend({doc:null,docObserver:function(){var doc=this.get('doc');var url=(doc)?doc.get('url'):'';if(url.length>0){url="/%@/%@/-docs/data/symbols/%@".fmt(window.urlPrefix,Docs.docsController.get('clientName'),url);}
var fdoc=(this.rootElement.contentWindow)?this.rootElement.contentWindow.document:this.rootElement.document;if(url==this.rootElement.src){if(fdoc&&fdoc.location)fdoc.location.reload();}else{this.rootElement.src=url;}}.observes('doc','isVisibleInWindow')});require('core');Docs.Doc=SC.Record.extend({icon:'sc-icon-document-16'});